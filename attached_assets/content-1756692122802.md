[Payments](https://razorpay.com/docs/payments)

[Server Integration](https://razorpay.com/docs/payments/server-integration)

[Nodejs](https://razorpay.com/docs/payments/server-integration/nodejs)

Integration Steps

# Integration Steps

Integrate your Node.js-based website with our SDK to start accepting payments using the Razorpay Payment Gateway.

Available in

![IN](https://flagcdn.com/in.svg)

India

![MY](https://flagcdn.com/my.svg)

Malaysia

![SG](https://flagcdn.com/sg.svg)

Singapore

* * *

#### [Payment Gateway](https://razorpay.com/docs/payments/server-integration/nodejs/integration-steps/\#Payment%20Gateway)

Integrate with Razorpay Payment Gateway.

#### [Other Razorpay Products](https://razorpay.com/docs/payments/server-integration/nodejs/integration-steps/\#Other%20Razorpay%20Products)

Integrate with other Razorpay products using API sample codes.

## [Integrate With Razorpay Payment Gateway](https://razorpay.com/docs/payments/server-integration/nodejs/integration-steps/\#integrate-with-razorpay-payment-gateway)

#### [Sample App](https://razorpay.com/docs/payments/server-integration/nodejs/integration-steps/\#Sample%20App)

We recommend you check the

[Node.js Sample App](https://razorpay.com/docs/build/browser/assets/images/razorpay-node-sample-project.zip)

, created using the video tutorial.

#### [GitHub Repository](https://razorpay.com/docs/payments/server-integration/nodejs/integration-steps/\#GitHub%20Repository)

Download the latest

[razorpay-node.zip](https://github.com/razorpay/razorpay-node/releases/)

file from GitHub. It is pre-compiled to include all dependencies.

### [Project Structure](https://razorpay.com/docs/payments/server-integration/nodejs/integration-steps/\#project-structure)

| File Name | Purpose |
| --- | --- |
| index.html | Contains Checkout code. |
| app.js | Contains Orders API and payment verification code. |
| success.html | A page to redirect users once the payment is successful. |

**Before you proceed:**

#### [1\. Build Integration](https://razorpay.com/docs/payments/server-integration/nodejs/integration-steps/\#1.%20Build%20Integration)

Integrate with your Node.js-based website.

#### [2\. Test Integration](https://razorpay.com/docs/payments/server-integration/nodejs/integration-steps/\#2.%20Test%20Integration)

Test the integration by making a test payment.

#### [3\. Go-live Checklist](https://razorpay.com/docs/payments/server-integration/nodejs/integration-steps/\#3.%20Go-live%20Checklist)

Check the go-live checklist.

### [1\. Build Integration](https://razorpay.com/docs/payments/server-integration/nodejs/integration-steps/\#1-build-integration)

#### 1.1 Instantiate Razorpay

In your server file, instantiate the Razorpay instance with your `key_id` and `key_secret`. You should generate the API keys on the Dashboard and add them here.

Given below is the command:

Instantiate the Razorpay Instance

copy

```

var instance = new Razorpay({

  key_id: 'YOUR_KEY_ID',

  key_secret: 'YOUR_KEY_SECRET',

});
```

The resources can be accessed using the instance. All the methods invocations follow the namespaced signature:

Resource

copy

```

// API signature

// {razorpayInstance}.{resourceName}.{methodName}(resourceId [, params])

// example

instance.payments.fetch(paymentId)
```

Every resource method returns a promise.

Promise

copy

```

instance.payments.all({

  from: '2016-08-01',

  to: '2016-08-20'

}).then((response) => {

  // handle success

}).catch((error) => {

  // handle error

})
```

If you want to use callbacks instead of promises, every resource method accepts a callback function as the last parameter. The callback function acts as **Error First Callbacks**.

Callbacks

copy

```

instance.payments.all({

  from: '2016-08-01',

  to: '2016-08-20'

}, (error, response) => {

  if (error) {

    // handle error

  } else {

    // handle success

  }

})
```

#### 1.2 Create an Order in Server

Order is an important step in the payment process.

- An order should be created for every payment.
- You can create an order using the
[Orders API](https://razorpay.com/docs/payments/server-integration/nodejs/integration-steps/#api-sample-code)
in the **app.js** file. It is a server-side API call. Know how to
[authenticate](https://razorpay.com/docs/api/authentication/#generate-api-keys)
Orders API.
- The `order_id` received in the response should be passed to checkout in the **index.html** file. This ties the Order with the payment and secures the request from being tampered.

#### 1.2.1 Sample Code

In the sample app, the **app.js** file contains the code for order creation using Orders API.

#### 1.2.2 Request Parameters

Here is the list of parameters for creating an order:

receipt

optional

`string` Your receipt id for this order should be passed here. Maximum length is 40 characters.

notes

optional

`json object` Key-value pair that can be used to store additional information about the entity. Maximum 15 key-value pairs, 256 characters (maximum) each. For example, `"note_key": "Beam me up Scotty”`.

partial\_payment

optional

`boolean` Indicates whether the customer can make a partial payment. Possible values:

- `true`: The customer can make partial payments.
- `false` (default): The customer cannot make partial payments.

first\_payment\_min\_amount

optional

`integer` Minimum amount that must be paid by the customer as the first partial payment. For example, if an amount of $7,000.00 is to be received from the customer in two installments of #1 - $5,000.00, #2 - $2,000.00 then you can set this value as `500000`. This parameter should be passed only if `partial_payment` is `true`.

Know more about

[Orders API](https://razorpay.com/docs/api/orders/)

.

#### 1.2.3 Response Parameters

Descriptions for the response parameters are present in the

[Orders Entity](https://razorpay.com/docs/api/orders/entity/)

table.

#### 1.2.4 Error Response Parameters

The error response parameters are available in the

[API Reference Guide](https://razorpay.com/docs/api/orders/#error-response-parameters)

.

#### 1.3 Add Checkout Options

Add the Razorpay Checkout options to your project. For example, if you are using HTML for your frontend, create a page called **index.html** and add the Pay button on your web page using the checkout code and either the callback URL or handler function.

#### 1.3.1 Callback URL or Handler Function

| **Callback URL** | **Handler Function** |
| --- | --- |
| When you use this: <br>- On successful payment, the customer is redirected to the specified URL, for example, a payment success page. <br>  <br>- On failure, the customer is asked to retry the payment. | When you use this: <br>- On successful payment, the customer is shown your web page.<br>  <br>- On failure, the customer is notified of the failure and asked to retry the payment. |

#### 1.3.2 Code to Add Pay Button

Copy-paste the parameters as options in your code:

**Handy Tips**

You can also integrate the Razorpay Checkout with

[React.js](https://razorpay.com/docs/payments/server-integration/nodejs/troubleshooting-faqs/#3-can-i-integrate-razorpay-checkout-with-reactjs)

using the sample code.

**Handy Tips**

Test the integration using these

[test cards](https://razorpay.com/docs/payments/server-integration/nodejs/integration-steps/#2-test-integration)

.

#### 1.3.3 Checkout Options

key

mandatory

`string` API Key ID generated from the Dashboard.

amount

mandatory

`integer` The amount to be paid by the customer in cents. For example, if the amount is $222.25, enter `22225`.

currency

mandatory

`string` The currency in which the payment should be made by the customer. Length must be of 3 characters.

name

mandatory

`string` Your Business/Enterprise name shown on the Checkout form. For example, **Acme Corp**.

description

optional

`string` Description of the purchase item shown on the Checkout form. It should start with an alphanumeric character.

image

optional

`string` Link to an image (usually your business logo) shown on the Checkout form. Can also be a **base64** string if you are not loading the image from a network.

order\_id

mandatory

`string` Order ID generated via

[Orders API](https://razorpay.com/docs/api/orders/)

.

prefill

`object` You can prefill the following details at Checkout.

**Boost Conversions and Minimise Drop-offs**

- Autofill customer contact details, especially phone number to ease form completion. Include customer’s phone number in the `contact` parameter of the JSON request's `prefill` object. Format: +(country code)(phone number). Example: "contact": "+11234567890".
- This is not applicable if you do not collect customer contact details on your website before checkout, have Shopify stores or use any of the no-code apps.

name

optional

`string` Cardholder's name to be prefilled if customer is to make card payments on Checkout. For example, **John Smith**.

email

optional

`string` Email address of the customer.

contact

optional

`string` Phone number of the customer. The expected format of the phone number is `+ {country code}{phone number}`. If the country code is not specified, `1` will be used as the default value. This is particularly important while prefilling `contact` of customers with phone numbers issued outside Singapore. **Examples**:

- +6591119111 (a valid non-American number)
- +11234567890 (a valid American number).

If 2125551234 is entered, `+1` is added to it as +12125551234.

method

optional

`string` Pre-selection of the payment method for the customer. Will only work if `contact` and `email` are also prefilled. Possible value is `card`.

notes

optional

`object` Set of key-value pairs that can be used to store additional information about the payment. It can hold a maximum of 15 key-value pairs, each 256 characters long (maximum).

theme

`object` Thematic options to modify the appearance of Checkout.

color

optional

`string` Enter your brand colour's HEX code to alter the text, payment method icons and CTA (call-to-action) button colour of the Checkout form.

backdrop\_color

optional

`string` Enter a HEX code to change the Checkout's backdrop colour.

modal

`object` Options to handle the Checkout modal.

backdropclose

optional

`boolean` Indicates whether clicking the translucent blank space outside the Checkout form should close the form. Possible values:

- `true`: Closes the form when your customer clicks outside the checkout form.
- `false` (default): Does not close the form when customer clicks outside the checkout form.

escape

optional

`boolean` Indicates whether pressing the **escape** key should close the Checkout form. Possible values:

- `true` (default): Closes the form when the customer presses the **escape** key.
- `false`: Does not close the form when the customer presses the **escape** key.

handleback

optional

`boolean` Determines whether Checkout must behave similar to the browser when back button is pressed. Possible values:

- `true` (default): Checkout behaves similarly to the browser. That is, when the browser's back button is pressed, the Checkout also simulates a back press. This happens as long as the Checkout modal is open.
- `false`: Checkout does not simulate a back press when browser's back button is pressed.

confirm\_close

optional

`boolean` Determines whether a confirmation dialog box should be shown if customers attempts to close Checkout. Possible values:

- `true`: Confirmation dialog box is shown.
- `false` (default): Confirmation dialog box is not shown.

ondismiss

optional

`function` Used to track the status of Checkout. You can pass a modal object with `ondismiss: function()\{\}` as options. This function is called when the modal is closed by the user. If `retry` is `false`, the `ondismiss` function is triggered when checkout closes, even after a failure.

animation

optional

`boolean` Shows an animation before loading of Checkout. Possible values:

- `true`(default): Animation appears.
- `false`: Animation does not appear.

callback\_url

optional

`string` Customers will be redirected to this URL on successful payment. Ensure that the domain of the Callback URL is allowlisted.

redirect

optional

`boolean` Determines whether to post a response to the event handler post payment completion or redirect to Callback URL. `callback_url` must be passed while using this parameter. Possible values:

- `true`: Customer is redirected to the specified callback URL in case of payment failure.
- `false` (default): Customer is shown the Checkout popup to retry the payment with the suggested next best option.

timeout

optional

`integer` Sets a timeout on Checkout, in seconds. After the specified time limit, the customer will not be able to use Checkout.

**Watch Out!**

Some browsers may pause `JavaScript` timers when the user switches tabs, especially in power saver mode. This can cause the checkout session to stay active beyond the set timeout duration.

readonly

`object` Marks fields as read-only.

contact

optional

`boolean` Used to set the `contact` field as readonly. Possible values:

- `true`: Customer will not be able to edit this field.
- `false` (default): Customer will be able to edit this field.

email

optional

`boolean` Used to set the `email` field as readonly. Possible values:

- `true`: Customer will not be able to edit this field.
- `false` (default): Customer will be able to edit this field.

name

optional

`boolean` Used to set the `name` field as readonly. Possible values:

- `true`: Customer will not be able to edit this field.
- `false` (default): Customer will be able to edit this field.

hidden

`object` Hides the contact details.

contact

optional

`boolean` Used to set the `contact` field as optional. Possible values:

- `true`: Customer will not be able to view this field.
- `false` (default): Customer will be able to view this field.

email

optional

`boolean` Used to set the `email` field as optional. Possible values:

- `true`: Customer will not be able to view this field.
- `false` (default): Customer will be able to view this field.

send\_sms\_hash

optional

`boolean` Used to auto-read OTP for cards. Applicable from Android SDK version 1.5.9 and above. Possible values:

- `true`: OTP is auto-read.
- `false` (default): OTP is not auto-read.

allow\_rotation

optional

`boolean` Used to rotate payment page as per screen orientation. Applicable from Android SDK version 1.6.4 and above. Possible values:

- `true`: Payment page can be rotated.
- `false` (default): Payment page cannot be rotated.

retry

optional

`object` Parameters that enable retry of payment on the checkout.

enabled

`boolean` Determines whether the customers can retry payments on the checkout. Possible values:

- `true` (default): Enables customers to retry payments.
- `false`: Disables customers from retrying the payment.

max\_count

`integer` The number of times the customer can retry the payment. We recommend you to set this to 4. Having a larger number here can cause loops to occur.

**Watch Out!**

Web Integration does not support the `max_count` parameter. It is applicable only in Android and iOS SDKs.

config

optional

`object` Parameters that enable configuration of checkout display language.

display

`object` Child parameter that enables configuration of checkout display language.

language

`string` The language in which checkout should be displayed. Possible value is `en`: English.

#### 1.3.4 Handle Payment Success and Failure

The way the Payment Success and Failure scenarios are handled depends on the

[Checkout Sample Code](https://razorpay.com/docs/payments/server-integration/nodejs/integration-steps/#132-code-to-add-pay-button)

you used in the last step.

#### Checkout with Callback URL

If you used the sample code with the callback URL:

On Payment Success

On Payment Failure

Razorpay makes a POST call to the callback URL with the **razorpay\_payment\_id**, **razorpay\_order\_id** and **razorpay\_signature** in the response object of the successful payment. Only successful authorisations are auto-submitted.

#### Checkout with Handler Function

If you used the sample code with the handler function:

On Payment Success

On Payment Failure

The customer sees your website page. The checkout returns the response object of the successful payment ( **razorpay\_payment\_id**, **razorpay\_order\_id** and **razorpay\_signature**). Collect these and send them to your server.

Use the Success/Failure Handling code given below:

Success Handling CodeFailure Handling Code

copy

```

"handler": function (response){

    alert(response.razorpay_payment_id);

    alert(response.razorpay_order_id);

    alert(response.razorpay_signature)}
```

#### 1.3.5 Configure Payment Methods _(Optional)_

Multiple payment methods are available on Razorpay Standard Checkout.

- The payment methods are **fixed** and cannot be changed.
- You can configure the order or make certain payment methods prominent. Know more about configuring payment methods. Know more about
[configuring payment methods](https://razorpay.com/docs/payments/payment-gateway/web-integration/standard/configure-payment-methods/)
.

#### 1.4 Store Fields in Your Server

A successful payment returns the following fields to the Checkout form.

- You need to store these fields in your server.
- You can confirm the authenticity of these details by verifying the signature in the next step.

razorpay\_payment\_id

`string` Unique identifier for the payment returned by Checkout **only** for successful payments.

razorpay\_order\_id

`string` Unique identifier for the order returned by Checkout.

razorpay\_signature

`string` Signature returned by the Checkout. This is used to verify the payment.

#### 1.5 Verify Payment Signature

This is a mandatory step that allows you to confirm the authenticity of the details returned to the checkout for successful payments.

To verify the `razorpay_signature` returned to you by the checkout:

1. Create a signature in your server using the following attributes:




| Attribute | Description |
| --- | --- |
| `order_id` | Retrieve the `order_id` from your server. Do not use the `razorpay_order_id` returned by checkout. |
| `razorpay_payment_id` | Returned during checkout. |
| `key_secret` | Available in your server. The `key_secret` that was generated from the <br>[Dashboard](https://razorpay.com/docs/api/authentication/#generate-api-keys)<br> . |

2. Use the SHA256 algorithm, the `razorpay_payment_id` and the `order_id` to construct an HMAC hex digest as shown below:








copy










```


generated_signature = hmac_sha256(order_id + "|" + razorpay_payment_id, secret);




       if (generated_signature == razorpay_signature) {

       payment is successful

        }
```

3. If the signature you generate on your server matches the `razorpay_signature` returned to you by the checkout, the payment received is from an authentic source.

Use the code given below to generate signature on your server:





Verify Payment Signature


copy










```


var instance = new Razorpay({ key_id: 'YOUR_KEY_ID', key_secret: 'YOUR_SECRET' })




var { validatePaymentVerification, validateWebhookSignature } = require('./dist/utils/razorpay-utils');

validatePaymentVerification({"order_id": razorpayOrderId, "payment_id": razorpayPaymentId }, signature, secret);
```









Add the following code in the front-end:





Call Signature Validate Method


copy










```


var settings = {

     "url": "/api/payment/verify",

     "method": "POST",

     "timeout": 0,

     "headers": {

      "Content-Type": "application/json"

     },

     "data": JSON.stringify({response}),

}
```


#### 1.6 Verify Payment Status

**Handy Tips**

On the Dashboard, ensure that the payment status is `captured`. Refer to the payment capture settings page to know how to

[capture payments automatically](https://razorpay.com/docs/payments/payments/capture-settings/)

.

You can track the payment status in three ways:

Verify Status from Dashboard

Subscribe to Webhook Events

Poll APIs

To verify the payment status from the Dashboard:

### [2\. Test Integration](https://razorpay.com/docs/payments/server-integration/nodejs/integration-steps/\#2-test-integration)

After the integration is complete, a **Pay** button appears on your webpage/app.

Click the button and make a test transaction to ensure the integration is working as expected. You can start accepting actual payments from your customers once the test transaction is successful.

You can make test payments using one of the payment methods configured at the Checkout.

**Watch Out!**

This is a mock payment page that uses your test API keys, test card and payment details.

- Ensure you have entered only your
[Test Mode API keys](https://razorpay.com/docs/payments/dashboard/account-settings/api-keys/#generate-api-keys)
in the Checkout code.
- No real money is deducted due to the usage of test API keys. This is a simulated transaction.

#### Supported Payment Methods

Following are all the payment modes that the customer can use to complete the payment on the Checkout. Some of them are available by default, while others may require approval from us. Raise a request from the Dashboard to enable such payment methods.

| Payment Method | Code | Availability |
| --- | --- | --- |
| [Debit and Credit Cards](https://razorpay.com/docs/payments/payment-methods/cards/) | `card` | ✓ |

Following are the payment methods supported as configured at Checkout.

#### [Cards](https://razorpay.com/docs/payments/server-integration/nodejs/integration-steps/\#Cards)

You can use one of the following test cards to test transactions for your integration in Test Mode.

- Use any valid expiration date in the future in the MM/YY format.
- Use any random CVV to create a successful payment.

| Card Network | Card Number |
| --- | --- |
| Visa | 4384 7968 2770 3274 |
| Mastercard | 5312 6865 5677 9641 |
| Amex | 3782 8224 6310 005 |
| Diners | 6500 5679 5403 3767 |
| Discover | 6011 0009 9013 9424 |

Check the list of

[supported card networks](https://razorpay.com/docs/payments/payment-methods/cards/)

.

### [3\. Go-live Checklist](https://razorpay.com/docs/payments/server-integration/nodejs/integration-steps/\#3-go-live-checklist)

Check the go-live checklist for Razorpay Web Standard Checkout integration. Consider these steps before taking the integration live.

#### 3.1 Accept Live Payments

You can perform an end-to-end simulation of funds flow in the Test Mode. Once confident that the integration is working as expected, switch to the Live Mode and start accepting payments from customers.

**Watch Out!**

Ensure you are switching your test API keys with API keys generated in Live Mode.

To generate API Keys in Live Mode on your Razorpay Dashboard:

1. Log in to the Razorpay Dashboard and switch to **Live Mode** on the menu.
2. Navigate to **Account & Settings** → **API Keys** → **Generate Key** to generate the API Key for Live Mode.
3. Download the keys and save them securely.
4. Replace the Test API Key with the Live Key in the Checkout code and start accepting actual payments.

#### 3.2 Payment Capture

After payment is `authorized`, you need to capture it to settle the amount to your bank account as per the settlement schedule. Payments that are not captured are auto-refunded after a fixed time.

**Watch Out**

- You should deliver the products or services to your customers only after the payment is captured. Razorpay automatically refunds all the uncaptured payments.
- You can track the payment status using our
[Fetch a Payment API](https://razorpay.com/docs/api/payments/#fetch-a-payment)
or webhooks.

Auto-capture Payments (Recommended)

Manually Capture Payments

Authorized payments can be automatically captured. You can auto-capture all payments

[using global settings](https://razorpay.com/docs/payments/payments/capture-settings/#auto-capture-all-payments)

on the Razorpay Dashboard. Know more about

[capture settings for payments](https://razorpay.com/docs/payments/payments/capture-settings/)

.

**Watch Out!**

Payment capture settings work only if you have integrated with Orders API on your server side. Know more about the

[Orders API](https://razorpay.com/docs/api/orders/create/)

.

#### 3.3 Set Up Webhooks

Ensure you have

[set up webhooks](https://razorpay.com/docs/webhooks/setup-edit-payments/)

in the live mode and configured the events for which you want to receive notifications.

## [Integrate With Other Razorpay Products](https://razorpay.com/docs/payments/server-integration/nodejs/integration-steps/\#integrate-with-other-razorpay-products)

Razorpay offers a range of

[payment products](https://razorpay.com/docs/get-started/)

to meet your business requirements. Visit our

[GitHub repository](https://github.com/razorpay/razorpay-node)

for the sample codes.

#### [Partner Authentication](https://razorpay.com/docs/payments/server-integration/nodejs/integration-steps/\#partner-authentication)

If you are a partner and want to use the API as a particular merchant, you must authenticate your account by passing an additional header `X-Razorpay-Account` with the merchant `account_id` as the value.

#### [Example](https://razorpay.com/docs/payments/server-integration/nodejs/integration-steps/\#example)

copy

```

var instance = new Razorpay({

  key_id: '<your_partner_key>',

  key_secret: '<your_partner_secret>',

  headers: {

    "X-Razorpay-Account": "<merchant_account_id>"

  }

});

instance.orders.all().then(console.log).catch(console.error);
```

### [Related Information](https://razorpay.com/docs/payments/server-integration/nodejs/integration-steps/\#related-information)

[Troubleshooting and FAQs](https://razorpay.com/docs/payments/server-integration/nodejs/troubleshooting-faqs/)

* * *

Is this integration guide useful?

Yes

No

* * *

integrate node.js

node.js sdk

payment gateway

integration steps

other products

ON THIS PAGE

- [Integrate With Razorpay Payment Gateway](https://razorpay.com/docs/payments/server-integration/nodejs/integration-steps/#integrate-with-razorpay-payment-gateway)

- [Project Structure](https://razorpay.com/docs/payments/server-integration/nodejs/integration-steps/#project-structure)

- [1\. Build Integration](https://razorpay.com/docs/payments/server-integration/nodejs/integration-steps/#1-build-integration)

- [2\. Test Integration](https://razorpay.com/docs/payments/server-integration/nodejs/integration-steps/#2-test-integration)

- [3\. Go-live Checklist](https://razorpay.com/docs/payments/server-integration/nodejs/integration-steps/#3-go-live-checklist)

- [Integrate With Other Razorpay Products](https://razorpay.com/docs/payments/server-integration/nodejs/integration-steps/#integrate-with-other-razorpay-products)

- [Related Information](https://razorpay.com/docs/payments/server-integration/nodejs/integration-steps/#related-information)


Back To Top